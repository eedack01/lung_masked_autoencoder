{
    "seed_everything": null,
    "trainer": {
      "logger": {
        "class_path": "pytorch_lightning.loggers.TensorBoardLogger",
        "init_args": {
          "save_dir": "logs",
          "name": "mae",
          "version": "vitmae_128_w_1.0_patch_8_2000",
          "default_hp_metric": false
        }
      },
      "enable_checkpointing": true,
      "callbacks": [
        {
          "class_path": "pytorch_lightning.callbacks.ModelCheckpoint",
          "init_args": {
            "filename": "best",
            "monitor": "val/l1_loss_avg",
            "mode": "min",
            "save_weights_only": true,
            "auto_insert_metric_name": false,
            "save_last": true
          }
        },
        {
          "class_path": "pytorch_lightning.callbacks.LearningRateMonitor",
          "init_args": {
            "logging_interval": "step"
          }
        },
        {
          "class_path": "pytorch_lightning.callbacks.TQDMProgressBar",
          "init_args":{
            "refresh_rate":10,
            "leave":true
          }
        }
      ],
      "default_root_dir": "ild_prognosis",
      "gradient_clip_val": null,
      "gradient_clip_algorithm": null,
      "num_nodes": 1,
      "devices": 1, 
      "accelerator": "gpu",
      "enable_progress_bar": true,
      "overfit_batches": 0.0,
      "check_val_every_n_epoch": 30,
      "fast_dev_run": false,
      "accumulate_grad_batches": 1,
      "max_epochs": 2000,
      "min_epochs": null,
      "max_steps": -1,
      "min_steps": null,
      "max_time": null,
      "limit_train_batches": 1.0,
      "limit_val_batches": 1.0,
      "limit_test_batches": 1.0,
      "limit_predict_batches": 1.0,
      "val_check_interval": 10.0,
      "log_every_n_steps": 5,
      "sync_batchnorm": false,
      "precision": 16,
      "enable_model_summary": true,
      "num_sanity_val_steps": 2,
      "profiler": null,
      "benchmark": true,
      "deterministic": false,
      "reload_dataloaders_every_n_epochs": 0,
      "detect_anomaly": false,
      "plugins": null
    },
    "model": {
        "model_name": "__main__.MAEtrainer",
        "model_dict": {
          "pretrained": null,
          "in_channels": 1,
          "img_size": [128, 128, 128],
          "patch_size": [8, 8, 8],
          "hidden_size": 768,
          "mlp_dim": 3072,
          "num_layers": 12,
          "num_heads": 12,
          "pos_embed": "perceptron",
          "dropout_rate": 0.0,
          "spatial_dims": 3,
          "masking_ratio": 0.75,
          "decoder_dim": 512,
          "decoder_heads": 8,
          "decoder_depth": 8,
          "revise_keys": []
        }
    },
    "data": {
      "class_path": "dataset.mae_dataset.MAEDataModule",
      "init_args": {
        "json_path": "config/mae_config.json",
        "downsample_ratio": [1.5, 1.5, 2.0],
        "batch_size": 8,
        "val_batch_size": 8,
        "num_workers": 4,
        "data_path":"data/mae/numpy_128", 
        "test_size":0.2,
        "random_state":42
      }
    },
    "ckpt_path": null
  }
